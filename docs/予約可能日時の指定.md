# 予約可能日時の指定方法

「その月の予約が何日・何時から開放されるか」を伝える方法です。月によって日時が違う場合に使います。

## 1. config.yaml で指定する（推奨）

`config.yaml` の **reservationOpensAt** で、その月の予約開放日時を指定します。

```yaml
# その月の予約開始日時（省略時はデフォルト: 当月23日 22:00）
reservationOpensAt:
  day: 23      # 日（1〜31）
  hour: 22     # 時（0〜23）
  minute: 0    # 分
```

**今月だけ違う場合の例**（例: 24日 10:00 から開放）

```yaml
reservationOpensAt:
  day: 24
  hour: 10
  minute: 0
```

- **未指定の場合**: デフォルトで「当月23日 22:00」として扱います（GitHub Actions のスケジュールも 23日22時 JST で実行）。
- 毎月同じなら `reservationOpensAt` は省略してかまいません。

## 2. 環境変数で上書きする（任意）

その実行だけ別の日時にしたい場合は、環境変数 **RESERVATION_OPENS_AT** で上書きできます。

- **形式**: `日T時:分`（例: `23T22:00`、`24T10:00`）
- **例**（今月だけ 24日 10:00 にする）:
  - ローカル: `RESERVATION_OPENS_AT=24T10:00 npm run reserve`
  - GitHub Actions: ワークフローの env や手動実行の input で `RESERVATION_OPENS_AT: "24T10:00"` を渡す

スクリプト側で `RESERVATION_OPENS_AT` を読んで config の `reservationOpensAt` を上書きする処理を入れておけば、GHA の手動実行で「今月は 24日 10:00」のように指定できます。

## 3. GitHub Actions での扱い

- **スケジュール実行**（毎月23日 22:00 JST）: 対象月は自動で「翌月」になり、予約開放日時は 23日22時を前提にしています。その月だけ違う場合は、事前に `config.example.yaml` の `reservationOpensAt` を更新してコミットするか、手動実行で `RESERVATION_OPENS_AT` を渡してください。
- **手動実行**: 必要なら「対象月」とあわせて、その月の予約開放日時を `RESERVATION_OPENS_AT` で指定できます。

## まとめ

| 方法 | いつ使うか |
|------|------------|
| config.yaml の `reservationOpensAt` | その月の予約開放日時を固定で指定したいとき（毎月同じなら省略可） |
| 環境変数 `RESERVATION_OPENS_AT` | 今回の実行だけ別の日時にしたいとき（例: 今月だけ 24日 10:00） |

予約**実行**のタイミング（いつスクリプトを動かすか）は、GitHub Actions の cron（23日22時）や手動実行で制御します。`reservationOpensAt` / `RESERVATION_OPENS_AT` は「その月は何日何時から予約可能か」の情報として、通知メッセージやログで参照する想定です。
